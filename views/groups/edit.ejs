<!DOCTYPE html>
<html lang="es" class="h-full">
  <head>
    <%- include('../partials/head') %>
    <title>Editar grupo <%= group.name %></title>
  </head>
  <body class="h-full flex flex-col bg-gray-50">
    <%- include('../partials/header') %>

    <main
      class="flex-1 max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-10 w-full pt-16"
    >
      <%- include('../partials/flash') %>

      <div class="bg-white shadow rounded-lg p-6 sm:p-8">
        <div class="mb-6">
          <h2
            class="text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2"
          >
            <%- renderIcon("edit", "text-3xl sm:text-4xl") %> Editar grupo
          </h2>
          <p class="text-gray-600 mt-2">
            Modifica los detalles de <%= group.name %>
          </p>
        </div>

        <form
          method="post"
          action="/groups/<%= group.id %>/edit"
          class="space-y-6"
        >
          <input type="hidden" name="_csrf" value="<%= csrfToken %>" />

          <!-- Nombre -->
          <div>
            <label
              for="name"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              <%- renderIcon("edit", "text-sm") %> Nombre del grupo
            </label>
            <input
              type="text"
              id="name"
              name="name"
              value="<%= group.name %>"
              required
              class="w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-red-500 focus:border-transparent outline-none text-sm"
              placeholder="Ej: Amigos de la U"
            />
          </div>

          <!-- Descripción -->
          <div>
            <label
              for="description"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              <%- renderIcon("description", "text-sm") %> Descripción
            </label>
            <textarea
              id="description"
              name="description"
              rows="3"
              class="w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-red-500 focus:border-transparent outline-none text-sm resize-none"
              placeholder="Ej: Secret Santa de navidad 2025"
            >
<%= group.description || '' %></textarea
            >
          </div>

          <!-- Precio máximo -->
          <div>
            <label
              for="price_max"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              <%- renderIcon("attach_money", "text-sm") %> Precio máximo del
              regalo
            </label>
            <input
              type="number"
              id="price_max"
              name="price_max"
              value="<%= group.priceMax || '' %>"
              step="0.01"
              min="0"
              class="w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-red-500 focus:border-transparent outline-none text-sm"
              placeholder="Ej: 50.00"
            />
          </div>

          <!-- Mínimo de participantes -->
          <div>
            <label
              for="min_participants"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              <%- renderIcon("people", "text-sm") %> Mínimo de participantes
            </label>
            <input
              type="number"
              id="min_participants"
              name="min_participants"
              value="<%= group.minParticipants || 2 %>"
              min="2"
              class="w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-red-500 focus:border-transparent outline-none text-sm"
            />
          </div>

          <!-- Fecha del evento -->
          <div>
            <label
              for="event_date"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              <%- renderIcon("event", "text-sm") %> Fecha del evento
            </label>
            <input
              type="date"
              id="event_date"
              name="event_date"
              value="<%= group.eventDate ? dayjs(group.eventDate).format('YYYY-MM-DD') : '' %>"
              class="w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-red-500 focus:border-transparent outline-none text-sm"
            />
          </div>

          <!-- Fecha límite de inscripción -->
          <div>
            <label
              for="draw_deadline"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              <%- renderIcon("schedule", "text-sm") %> Fecha límite de
              inscripción
            </label>
            <input
              type="date"
              id="draw_deadline"
              name="draw_deadline"
              value="<%= group.drawDeadline ? dayjs(group.drawDeadline).format('YYYY-MM-DD') : '' %>"
              class="w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-red-500 focus:border-transparent outline-none text-sm"
            />
          </div>

          <!-- Reglas -->
          <div>
            <label
              for="rules"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              <%- renderIcon("rule", "text-sm") %> Reglas del grupo
            </label>
            <textarea
              id="rules"
              name="rules"
              rows="4"
              class="w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-red-500 focus:border-transparent outline-none text-sm resize-none"
              placeholder="Ej: No revelarse antes del evento&#10;Máximo una compra por persona&#10;..."
            >
<%= group.rules || '' %></textarea
            >
          </div>

          <!-- Icono -->
          <div>
            <label
              for="icon"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              <%- renderIcon("emoji_emotions", "text-sm") %> Icono (Material
              Symbols)
            </label>
            <input
              type="text"
              id="icon"
              name="icon"
              value="<%= group.icon || 'favorite' %>"
              class="w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-red-500 focus:border-transparent outline-none text-sm"
              placeholder="Ej: favorite, star, cake"
            />
            <p class="text-xs text-gray-500 mt-1">
              Usa nombres de iconos de Material Symbols (favorite, star, cake,
              gift, heart, etc.)
            </p>
          </div>

          <!-- Color -->
          <div>
            <label
              for="color"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              <%- renderIcon("palette", "text-sm") %> Color del grupo
            </label>
            <input
              type="color"
              id="color"
              name="color"
              value="<%= group.color || '#DC2626' %>"
              class="w-full h-12 border border-gray-300 rounded-md cursor-pointer"
            />
          </div>

          <!-- Botones de acción -->
          <div class="flex flex-col sm:flex-row gap-3 pt-4">
            <a
              href="/groups/<%= group.id %>"
              class="inline-flex items-center justify-center gap-2 px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50 transition"
            >
              <%- renderIcon("close", "text-base") %> Cancelar
            </a>
            <button
              type="submit"
              class="inline-flex items-center justify-center gap-2 px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 transition"
            >
              <%- renderIcon("check", "text-base") %> Guardar cambios
            </button>
          </div>
        </form>
      </div>
    </main>

    <%- include('../partials/footer') %>
  </body>
</html>
